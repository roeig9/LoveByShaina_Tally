<div id="map" style="width: 100%; height: 350px; border-radius: 10px;"></div>

<script>
  // 1. Load Leaflet
  const leafletCSS = document.createElement("link");
  leafletCSS.rel = "stylesheet";
  leafletCSS.href = "https://unpkg.com/leaflet@1.9.4/dist/leaflet.css";
  document.head.appendChild(leafletCSS);

  const leafletJS = document.createElement("script");
  leafletJS.src = "https://unpkg.com/leaflet@1.9.4/dist/leaflet.js";
  leafletJS.onload = initMap;
  document.head.appendChild(leafletJS);

  let marker;

  function initMap() {
    // 2. Create map
    const map = L.map("map", {
      zoomControl: false   // remove default top-left zoom
    }).setView([32.0853, 34.7818], 13);

    // 3. Add zoom buttons bottom-right
    L.control.zoom({ position: "bottomright" }).addTo(map);

    // 4. Add tile layer
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19
    }).addTo(map);

    // 5. Add draggable marker
    marker = L.marker([32.0853, 34.7818], { draggable: true }).addTo(map);
  }

  // 6. When user tries to submit the Tally form â†’ automatically save coordinates
  document.addEventListener("click", function (e) {
    const btn = e.target.closest("button[type='submit']");
    if (!btn) return;

    if (!marker) return;

    const pos = marker.getLatLng();
    
    // Replace these with your Tally field IDs!
    document.querySelector("input[name='lat']").value = pos.lat;
    document.querySelector("input[name='lng']").value = pos.lng;
  });
</script>
